import { useEffect, useRef, useState } from "react";
import Peer from "simple-peer";
import "./App.css";
import Video from "./Video";

function App() {
  const [me, setMe] = useState("");
  const [stream, setStream] = useState();
  const [receivingCall, setReceivingCall] = useState(false);
  const [caller, setCaller] = useState("");
  const [callerSignal, setCallerSignal] = useState();
  const [callAccepted, setCallAccepted] = useState(false);
  const [idToCall, setIdToCall] = useState("");
  const [callEnded, setCallEnded] = useState(false);
  const [name, setName] = useState("");
  const myVideo = useRef();
  const userVideo = useRef();
  const connectionRef = useRef();

  useEffect(() => {
    navigator.mediaDevices
      .getUserMedia({ video: true, audio: true })
      .then((stream) => {
        setStream(stream);
        myVideo.current.srcObject = stream;
      });
  }, []);

  const callUser = (id) => {
    const peer = new Peer({
      initiator: true,
      trickle: false,
      stream: stream,
    });

    peer.on("signal", (data) => {
      console.log("Calluser signal", data);
    });

    peer.on("stream", (stream) => {
      console.log("Calluser stream", stream);
      userVideo.current.srcObject = stream;
    });

    // peer.signal({
    //   type: "answer",
    //   sdp: "v=0\r\no=- 6871640382854268603 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\na=group:BUNDLE 0 1 2\r\na=extmap-allow-mixed\r\na=msid-semantic: WMS wadDKIOQ0vl2LzmShXPPBzZZsKhISZvuZ4kT\r\nm=audio 56794 UDP/TLS/RTP/SAVPF 111 63 103 104 9 0 8 106 105 13 110 112 113 126\r\nc=IN IP4 192.168.31.197\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 56794 typ host generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:bVsx\r\na=ice-pwd:HEQx2t3/G1swMiKa2yJhUGB/\r\na=fingerprint:sha-256 68:1B:7A:68:DC:4C:D3:82:B4:33:DD:4F:B2:F4:CB:62:E5:E2:90:33:97:41:B9:2E:39:E9:EA:68:8A:80:12:48\r\na=setup:active\r\na=mid:0\r\na=extmap:1 urn:ietf:params:rtp-hdrext:ssrc-audio-level\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=sendrecv\r\na=msid:wadDKIOQ0vl2LzmShXPPBzZZsKhISZvuZ4kT ababfa9e-f3af-43a4-915e-fa763e8905af\r\na=rtcp-mux\r\na=rtpmap:111 opus/48000/2\r\na=rtcp-fb:111 transport-cc\r\na=fmtp:111 minptime=10;useinbandfec=1\r\na=rtpmap:63 red/48000/2\r\na=fmtp:63 111/111\r\na=rtpmap:103 ISAC/16000\r\na=rtpmap:104 ISAC/32000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:106 CN/32000\r\na=rtpmap:105 CN/16000\r\na=rtpmap:13 CN/8000\r\na=rtpmap:110 telephone-event/48000\r\na=rtpmap:112 telephone-event/32000\r\na=rtpmap:113 telephone-event/16000\r\na=rtpmap:126 telephone-event/8000\r\na=ssrc:2958246724 cname:R7q8lwzrBv3DvVAs\r\nm=video 9 UDP/TLS/RTP/SAVPF 96 97 98 99 100 101 127 121 125 107 108 109 124 120 123 119 35 36 41 42 114 115 116\r\nc=IN IP4 0.0.0.0\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=ice-ufrag:bVsx\r\na=ice-pwd:HEQx2t3/G1swMiKa2yJhUGB/\r\na=fingerprint:sha-256 68:1B:7A:68:DC:4C:D3:82:B4:33:DD:4F:B2:F4:CB:62:E5:E2:90:33:97:41:B9:2E:39:E9:EA:68:8A:80:12:48\r\na=setup:active\r\na=mid:1\r\na=extmap:14 urn:ietf:params:rtp-hdrext:toffset\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:13 urn:3gpp:video-orientation\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:5 http://www.webrtc.org/experiments/rtp-hdrext/playout-delay\r\na=extmap:6 http://www.webrtc.org/experiments/rtp-hdrext/video-content-type\r\na=extmap:7 http://www.webrtc.org/experiments/rtp-hdrext/video-timing\r\na=extmap:8 http://www.webrtc.org/experiments/rtp-hdrext/color-space\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=extmap:10 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id\r\na=extmap:11 urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id\r\na=sendrecv\r\na=msid:wadDKIOQ0vl2LzmShXPPBzZZsKhISZvuZ4kT e19f2e99-e575-47c0-be39-cf7a45ddb23c\r\na=rtcp-mux\r\na=rtcp-rsize\r\na=rtpmap:96 VP8/90000\r\na=rtcp-fb:96 goog-remb\r\na=rtcp-fb:96 transport-cc\r\na=rtcp-fb:96 ccm fir\r\na=rtcp-fb:96 nack\r\na=rtcp-fb:96 nack pli\r\na=rtpmap:97 rtx/90000\r\na=fmtp:97 apt=96\r\na=rtpmap:98 VP9/90000\r\na=rtcp-fb:98 goog-remb\r\na=rtcp-fb:98 transport-cc\r\na=rtcp-fb:98 ccm fir\r\na=rtcp-fb:98 nack\r\na=rtcp-fb:98 nack pli\r\na=fmtp:98 profile-id=0\r\na=rtpmap:99 rtx/90000\r\na=fmtp:99 apt=98\r\na=rtpmap:100 VP9/90000\r\na=rtcp-fb:100 goog-remb\r\na=rtcp-fb:100 transport-cc\r\na=rtcp-fb:100 ccm fir\r\na=rtcp-fb:100 nack\r\na=rtcp-fb:100 nack pli\r\na=fmtp:100 profile-id=2\r\na=rtpmap:101 rtx/90000\r\na=fmtp:101 apt=100\r\na=rtpmap:127 H264/90000\r\na=rtcp-fb:127 goog-remb\r\na=rtcp-fb:127 transport-cc\r\na=rtcp-fb:127 ccm fir\r\na=rtcp-fb:127 nack\r\na=rtcp-fb:127 nack pli\r\na=fmtp:127 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f\r\na=rtpmap:121 rtx/90000\r\na=fmtp:121 apt=127\r\na=rtpmap:125 H264/90000\r\na=rtcp-fb:125 goog-remb\r\na=rtcp-fb:125 transport-cc\r\na=rtcp-fb:125 ccm fir\r\na=rtcp-fb:125 nack\r\na=rtcp-fb:125 nack pli\r\na=fmtp:125 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42001f\r\na=rtpmap:107 rtx/90000\r\na=fmtp:107 apt=125\r\na=rtpmap:108 H264/90000\r\na=rtcp-fb:108 goog-remb\r\na=rtcp-fb:108 transport-cc\r\na=rtcp-fb:108 ccm fir\r\na=rtcp-fb:108 nack\r\na=rtcp-fb:108 nack pli\r\na=fmtp:108 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\na=rtpmap:109 rtx/90000\r\na=fmtp:109 apt=108\r\na=rtpmap:124 H264/90000\r\na=rtcp-fb:124 goog-remb\r\na=rtcp-fb:124 transport-cc\r\na=rtcp-fb:124 ccm fir\r\na=rtcp-fb:124 nack\r\na=rtcp-fb:124 nack pli\r\na=fmtp:124 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42e01f\r\na=rtpmap:120 rtx/90000\r\na=fmtp:120 apt=124\r\na=rtpmap:123 H264/90000\r\na=rtcp-fb:123 goog-remb\r\na=rtcp-fb:123 transport-cc\r\na=rtcp-fb:123 ccm fir\r\na=rtcp-fb:123 nack\r\na=rtcp-fb:123 nack pli\r\na=fmtp:123 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f\r\na=rtpmap:119 rtx/90000\r\na=fmtp:119 apt=123\r\na=rtpmap:35 H264/90000\r\na=rtcp-fb:35 goog-remb\r\na=rtcp-fb:35 transport-cc\r\na=rtcp-fb:35 ccm fir\r\na=rtcp-fb:35 nack\r\na=rtcp-fb:35 nack pli\r\na=fmtp:35 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=4d001f\r\na=rtpmap:36 rtx/90000\r\na=fmtp:36 apt=35\r\na=rtpmap:41 AV1/90000\r\na=rtcp-fb:41 goog-remb\r\na=rtcp-fb:41 transport-cc\r\na=rtcp-fb:41 ccm fir\r\na=rtcp-fb:41 nack\r\na=rtcp-fb:41 nack pli\r\na=rtpmap:42 rtx/90000\r\na=fmtp:42 apt=41\r\na=rtpmap:114 red/90000\r\na=rtpmap:115 rtx/90000\r\na=fmtp:115 apt=114\r\na=rtpmap:116 ulpfec/90000\r\na=ssrc-group:FID 3010773336 2030164345\r\na=ssrc:3010773336 cname:R7q8lwzrBv3DvVAs\r\na=ssrc:2030164345 cname:R7q8lwzrBv3DvVAs\r\nm=application 9 UDP/DTLS/SCTP webrtc-datachannel\r\nc=IN IP4 0.0.0.0\r\na=ice-ufrag:bVsx\r\na=ice-pwd:HEQx2t3/G1swMiKa2yJhUGB/\r\na=fingerprint:sha-256 68:1B:7A:68:DC:4C:D3:82:B4:33:DD:4F:B2:F4:CB:62:E5:E2:90:33:97:41:B9:2E:39:E9:EA:68:8A:80:12:48\r\na=setup:active\r\na=mid:2\r\na=sctp-port:5000\r\na=max-message-size:262144\r\n",
    // });
    connectionRef.current = peer;
  };

  const answerCall = () => {
    const peer = new Peer({
      initiator: false,
      trickle: false,
      stream: stream,
    });

    peer.on("signal", (data) => {
      console.log("answerCall signal", data);
    });

    peer.on("stream", (stream) => {
      console.log("answerCall stream", stream);
      userVideo.current.srcObject = stream;
    });

    // peer.signal({
    //   type: "offer",
    //   sdp: "v=0\r\no=- 1209795441272215010 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\na=group:BUNDLE 0 1 2\r\na=extmap-allow-mixed\r\na=msid-semantic: WMS tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9\r\nm=audio 10378 UDP/TLS/RTP/SAVPF 111 63 103 104 9 0 8 106 105 13 110 112 113 126\r\nc=IN IP4 150.107.241.94\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 59254 typ host generation 0 network-id 1 network-cost 10\r\na=candidate:4117300730 1 udp 1686052607 150.107.241.94 10378 typ srflx raddr 192.168.31.197 rport 59254 generation 0 network-id 1 network-cost 10\r\na=candidate:2003289753 1 tcp 1518280447 192.168.31.197 9 typ host tcptype active generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:LgP1\r\na=ice-pwd:hn9CyopXPVR92biqyvIjB2Hl\r\na=fingerprint:sha-256 A9:82:4E:3F:FA:F7:95:A2:67:30:25:6F:87:D6:E7:79:88:C8:84:92:35:7A:AB:25:AF:36:1A:99:1A:D5:5D:71\r\na=setup:actpass\r\na=mid:0\r\na=extmap:1 urn:ietf:params:rtp-hdrext:ssrc-audio-level\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=sendrecv\r\na=msid:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9 5c3332c6-a791-47e6-94e2-a3e525c28a57\r\na=rtcp-mux\r\na=rtpmap:111 opus/48000/2\r\na=rtcp-fb:111 transport-cc\r\na=fmtp:111 minptime=10;useinbandfec=1\r\na=rtpmap:63 red/48000/2\r\na=fmtp:63 111/111\r\na=rtpmap:103 ISAC/16000\r\na=rtpmap:104 ISAC/32000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:106 CN/32000\r\na=rtpmap:105 CN/16000\r\na=rtpmap:13 CN/8000\r\na=rtpmap:110 telephone-event/48000\r\na=rtpmap:112 telephone-event/32000\r\na=rtpmap:113 telephone-event/16000\r\na=rtpmap:126 telephone-event/8000\r\na=ssrc:1194669609 cname:oG/qc2rAin3C0jsJ\r\na=ssrc:1194669609 msid:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9 5c3332c6-a791-47e6-94e2-a3e525c28a57\r\na=ssrc:1194669609 mslabel:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9\r\na=ssrc:1194669609 label:5c3332c6-a791-47e6-94e2-a3e525c28a57\r\nm=video 9809 UDP/TLS/RTP/SAVPF 96 97 98 99 100 101 127 121 125 107 108 109 124 120 123 119 35 36 41 42 114 115 116\r\nc=IN IP4 150.107.241.94\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 35629 typ host generation 0 network-id 1 network-cost 10\r\na=candidate:4117300730 1 udp 1686052607 150.107.241.94 9809 typ srflx raddr 192.168.31.197 rport 35629 generation 0 network-id 1 network-cost 10\r\na=candidate:2003289753 1 tcp 1518280447 192.168.31.197 9 typ host tcptype active generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:LgP1\r\na=ice-pwd:hn9CyopXPVR92biqyvIjB2Hl\r\na=fingerprint:sha-256 A9:82:4E:3F:FA:F7:95:A2:67:30:25:6F:87:D6:E7:79:88:C8:84:92:35:7A:AB:25:AF:36:1A:99:1A:D5:5D:71\r\na=setup:actpass\r\na=mid:1\r\na=extmap:14 urn:ietf:params:rtp-hdrext:toffset\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:13 urn:3gpp:video-orientation\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:5 http://www.webrtc.org/experiments/rtp-hdrext/playout-delay\r\na=extmap:6 http://www.webrtc.org/experiments/rtp-hdrext/video-content-type\r\na=extmap:7 http://www.webrtc.org/experiments/rtp-hdrext/video-timing\r\na=extmap:8 http://www.webrtc.org/experiments/rtp-hdrext/color-space\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=extmap:10 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id\r\na=extmap:11 urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id\r\na=sendrecv\r\na=msid:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9 b9b86bde-02a2-4e9f-9b91-33e9e70d7bc0\r\na=rtcp-mux\r\na=rtcp-rsize\r\na=rtpmap:96 VP8/90000\r\na=rtcp-fb:96 goog-remb\r\na=rtcp-fb:96 transport-cc\r\na=rtcp-fb:96 ccm fir\r\na=rtcp-fb:96 nack\r\na=rtcp-fb:96 nack pli\r\na=rtpmap:97 rtx/90000\r\na=fmtp:97 apt=96\r\na=rtpmap:98 VP9/90000\r\na=rtcp-fb:98 goog-remb\r\na=rtcp-fb:98 transport-cc\r\na=rtcp-fb:98 ccm fir\r\na=rtcp-fb:98 nack\r\na=rtcp-fb:98 nack pli\r\na=fmtp:98 profile-id=0\r\na=rtpmap:99 rtx/90000\r\na=fmtp:99 apt=98\r\na=rtpmap:100 VP9/90000\r\na=rtcp-fb:100 goog-remb\r\na=rtcp-fb:100 transport-cc\r\na=rtcp-fb:100 ccm fir\r\na=rtcp-fb:100 nack\r\na=rtcp-fb:100 nack pli\r\na=fmtp:100 profile-id=2\r\na=rtpmap:101 rtx/90000\r\na=fmtp:101 apt=100\r\na=rtpmap:127 H264/90000\r\na=rtcp-fb:127 goog-remb\r\na=rtcp-fb:127 transport-cc\r\na=rtcp-fb:127 ccm fir\r\na=rtcp-fb:127 nack\r\na=rtcp-fb:127 nack pli\r\na=fmtp:127 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f\r\na=rtpmap:121 rtx/90000\r\na=fmtp:121 apt=127\r\na=rtpmap:125 H264/90000\r\na=rtcp-fb:125 goog-remb\r\na=rtcp-fb:125 transport-cc\r\na=rtcp-fb:125 ccm fir\r\na=rtcp-fb:125 nack\r\na=rtcp-fb:125 nack pli\r\na=fmtp:125 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42001f\r\na=rtpmap:107 rtx/90000\r\na=fmtp:107 apt=125\r\na=rtpmap:108 H264/90000\r\na=rtcp-fb:108 goog-remb\r\na=rtcp-fb:108 transport-cc\r\na=rtcp-fb:108 ccm fir\r\na=rtcp-fb:108 nack\r\na=rtcp-fb:108 nack pli\r\na=fmtp:108 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\na=rtpmap:109 rtx/90000\r\na=fmtp:109 apt=108\r\na=rtpmap:124 H264/90000\r\na=rtcp-fb:124 goog-remb\r\na=rtcp-fb:124 transport-cc\r\na=rtcp-fb:124 ccm fir\r\na=rtcp-fb:124 nack\r\na=rtcp-fb:124 nack pli\r\na=fmtp:124 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42e01f\r\na=rtpmap:120 rtx/90000\r\na=fmtp:120 apt=124\r\na=rtpmap:123 H264/90000\r\na=rtcp-fb:123 goog-remb\r\na=rtcp-fb:123 transport-cc\r\na=rtcp-fb:123 ccm fir\r\na=rtcp-fb:123 nack\r\na=rtcp-fb:123 nack pli\r\na=fmtp:123 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f\r\na=rtpmap:119 rtx/90000\r\na=fmtp:119 apt=123\r\na=rtpmap:35 H264/90000\r\na=rtcp-fb:35 goog-remb\r\na=rtcp-fb:35 transport-cc\r\na=rtcp-fb:35 ccm fir\r\na=rtcp-fb:35 nack\r\na=rtcp-fb:35 nack pli\r\na=fmtp:35 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=4d001f\r\na=rtpmap:36 rtx/90000\r\na=fmtp:36 apt=35\r\na=rtpmap:41 AV1/90000\r\na=rtcp-fb:41 goog-remb\r\na=rtcp-fb:41 transport-cc\r\na=rtcp-fb:41 ccm fir\r\na=rtcp-fb:41 nack\r\na=rtcp-fb:41 nack pli\r\na=rtpmap:42 rtx/90000\r\na=fmtp:42 apt=41\r\na=rtpmap:114 red/90000\r\na=rtpmap:115 rtx/90000\r\na=fmtp:115 apt=114\r\na=rtpmap:116 ulpfec/90000\r\na=ssrc-group:FID 2968054639 3432089576\r\na=ssrc:2968054639 cname:oG/qc2rAin3C0jsJ\r\na=ssrc:2968054639 msid:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9 b9b86bde-02a2-4e9f-9b91-33e9e70d7bc0\r\na=ssrc:2968054639 mslabel:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9\r\na=ssrc:2968054639 label:b9b86bde-02a2-4e9f-9b91-33e9e70d7bc0\r\na=ssrc:3432089576 cname:oG/qc2rAin3C0jsJ\r\na=ssrc:3432089576 msid:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9 b9b86bde-02a2-4e9f-9b91-33e9e70d7bc0\r\na=ssrc:3432089576 mslabel:tQuV6bW5GuPcALoiHBFxXzvGcql5yQULnIX9\r\na=ssrc:3432089576 label:b9b86bde-02a2-4e9f-9b91-33e9e70d7bc0\r\nm=application 10389 UDP/DTLS/SCTP webrtc-datachannel\r\nc=IN IP4 150.107.241.94\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 59075 typ host generation 0 network-id 1 network-cost 10\r\na=candidate:4117300730 1 udp 1686052607 150.107.241.94 10389 typ srflx raddr 192.168.31.197 rport 59075 generation 0 network-id 1 network-cost 10\r\na=candidate:2003289753 1 tcp 1518280447 192.168.31.197 9 typ host tcptype active generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:LgP1\r\na=ice-pwd:hn9CyopXPVR92biqyvIjB2Hl\r\na=fingerprint:sha-256 A9:82:4E:3F:FA:F7:95:A2:67:30:25:6F:87:D6:E7:79:88:C8:84:92:35:7A:AB:25:AF:36:1A:99:1A:D5:5D:71\r\na=setup:actpass\r\na=mid:2\r\na=sctp-port:5000\r\na=max-message-size:262144\r\n",
    // });
    connectionRef.current = peer;
  };

  const callsignal = () => {
    connectionRef.current.signal({
      type: "answer",
      sdp: "v=0\r\no=- 4556312740280737398 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\na=group:BUNDLE 0 1 2\r\na=extmap-allow-mixed\r\na=msid-semantic: WMS HwPCAdYcqMExj1hhckx8QNUOvV61UMVPpm7E\r\nm=audio 33018 UDP/TLS/RTP/SAVPF 111 63 103 104 9 0 8 106 105 13 110 112 113 126\r\nc=IN IP4 192.168.31.197\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 33018 typ host generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:tCZF\r\na=ice-pwd:72l2iBynEfefBHSECOvzxWZ0\r\na=fingerprint:sha-256 C2:AA:58:AB:78:8D:2D:D3:FC:0E:06:21:5F:EF:53:22:0E:6A:7C:F2:93:EC:8F:FA:70:10:E5:5E:4E:D1:B0:37\r\na=setup:active\r\na=mid:0\r\na=extmap:1 urn:ietf:params:rtp-hdrext:ssrc-audio-level\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=sendrecv\r\na=msid:HwPCAdYcqMExj1hhckx8QNUOvV61UMVPpm7E fac44bd0-11f0-497b-b037-128602f9cc61\r\na=rtcp-mux\r\na=rtpmap:111 opus/48000/2\r\na=rtcp-fb:111 transport-cc\r\na=fmtp:111 minptime=10;useinbandfec=1\r\na=rtpmap:63 red/48000/2\r\na=fmtp:63 111/111\r\na=rtpmap:103 ISAC/16000\r\na=rtpmap:104 ISAC/32000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:106 CN/32000\r\na=rtpmap:105 CN/16000\r\na=rtpmap:13 CN/8000\r\na=rtpmap:110 telephone-event/48000\r\na=rtpmap:112 telephone-event/32000\r\na=rtpmap:113 telephone-event/16000\r\na=rtpmap:126 telephone-event/8000\r\na=ssrc:2615799317 cname:v+XQz6TBI6MEnK7e\r\nm=video 9 UDP/TLS/RTP/SAVPF 96 97 98 99 100 101 127 121 125 107 108 109 124 120 123 119 35 36 41 42 114 115 116\r\nc=IN IP4 0.0.0.0\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=ice-ufrag:tCZF\r\na=ice-pwd:72l2iBynEfefBHSECOvzxWZ0\r\na=fingerprint:sha-256 C2:AA:58:AB:78:8D:2D:D3:FC:0E:06:21:5F:EF:53:22:0E:6A:7C:F2:93:EC:8F:FA:70:10:E5:5E:4E:D1:B0:37\r\na=setup:active\r\na=mid:1\r\na=extmap:14 urn:ietf:params:rtp-hdrext:toffset\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:13 urn:3gpp:video-orientation\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:5 http://www.webrtc.org/experiments/rtp-hdrext/playout-delay\r\na=extmap:6 http://www.webrtc.org/experiments/rtp-hdrext/video-content-type\r\na=extmap:7 http://www.webrtc.org/experiments/rtp-hdrext/video-timing\r\na=extmap:8 http://www.webrtc.org/experiments/rtp-hdrext/color-space\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=extmap:10 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id\r\na=extmap:11 urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id\r\na=sendrecv\r\na=msid:HwPCAdYcqMExj1hhckx8QNUOvV61UMVPpm7E 37a11f36-458c-4fb6-8530-e26d942a1848\r\na=rtcp-mux\r\na=rtcp-rsize\r\na=rtpmap:96 VP8/90000\r\na=rtcp-fb:96 goog-remb\r\na=rtcp-fb:96 transport-cc\r\na=rtcp-fb:96 ccm fir\r\na=rtcp-fb:96 nack\r\na=rtcp-fb:96 nack pli\r\na=rtpmap:97 rtx/90000\r\na=fmtp:97 apt=96\r\na=rtpmap:98 VP9/90000\r\na=rtcp-fb:98 goog-remb\r\na=rtcp-fb:98 transport-cc\r\na=rtcp-fb:98 ccm fir\r\na=rtcp-fb:98 nack\r\na=rtcp-fb:98 nack pli\r\na=fmtp:98 profile-id=0\r\na=rtpmap:99 rtx/90000\r\na=fmtp:99 apt=98\r\na=rtpmap:100 VP9/90000\r\na=rtcp-fb:100 goog-remb\r\na=rtcp-fb:100 transport-cc\r\na=rtcp-fb:100 ccm fir\r\na=rtcp-fb:100 nack\r\na=rtcp-fb:100 nack pli\r\na=fmtp:100 profile-id=2\r\na=rtpmap:101 rtx/90000\r\na=fmtp:101 apt=100\r\na=rtpmap:127 H264/90000\r\na=rtcp-fb:127 goog-remb\r\na=rtcp-fb:127 transport-cc\r\na=rtcp-fb:127 ccm fir\r\na=rtcp-fb:127 nack\r\na=rtcp-fb:127 nack pli\r\na=fmtp:127 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f\r\na=rtpmap:121 rtx/90000\r\na=fmtp:121 apt=127\r\na=rtpmap:125 H264/90000\r\na=rtcp-fb:125 goog-remb\r\na=rtcp-fb:125 transport-cc\r\na=rtcp-fb:125 ccm fir\r\na=rtcp-fb:125 nack\r\na=rtcp-fb:125 nack pli\r\na=fmtp:125 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42001f\r\na=rtpmap:107 rtx/90000\r\na=fmtp:107 apt=125\r\na=rtpmap:108 H264/90000\r\na=rtcp-fb:108 goog-remb\r\na=rtcp-fb:108 transport-cc\r\na=rtcp-fb:108 ccm fir\r\na=rtcp-fb:108 nack\r\na=rtcp-fb:108 nack pli\r\na=fmtp:108 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\na=rtpmap:109 rtx/90000\r\na=fmtp:109 apt=108\r\na=rtpmap:124 H264/90000\r\na=rtcp-fb:124 goog-remb\r\na=rtcp-fb:124 transport-cc\r\na=rtcp-fb:124 ccm fir\r\na=rtcp-fb:124 nack\r\na=rtcp-fb:124 nack pli\r\na=fmtp:124 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42e01f\r\na=rtpmap:120 rtx/90000\r\na=fmtp:120 apt=124\r\na=rtpmap:123 H264/90000\r\na=rtcp-fb:123 goog-remb\r\na=rtcp-fb:123 transport-cc\r\na=rtcp-fb:123 ccm fir\r\na=rtcp-fb:123 nack\r\na=rtcp-fb:123 nack pli\r\na=fmtp:123 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f\r\na=rtpmap:119 rtx/90000\r\na=fmtp:119 apt=123\r\na=rtpmap:35 H264/90000\r\na=rtcp-fb:35 goog-remb\r\na=rtcp-fb:35 transport-cc\r\na=rtcp-fb:35 ccm fir\r\na=rtcp-fb:35 nack\r\na=rtcp-fb:35 nack pli\r\na=fmtp:35 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=4d001f\r\na=rtpmap:36 rtx/90000\r\na=fmtp:36 apt=35\r\na=rtpmap:41 AV1/90000\r\na=rtcp-fb:41 goog-remb\r\na=rtcp-fb:41 transport-cc\r\na=rtcp-fb:41 ccm fir\r\na=rtcp-fb:41 nack\r\na=rtcp-fb:41 nack pli\r\na=rtpmap:42 rtx/90000\r\na=fmtp:42 apt=41\r\na=rtpmap:114 red/90000\r\na=rtpmap:115 rtx/90000\r\na=fmtp:115 apt=114\r\na=rtpmap:116 ulpfec/90000\r\na=ssrc-group:FID 2840064164 2176931595\r\na=ssrc:2840064164 cname:v+XQz6TBI6MEnK7e\r\na=ssrc:2176931595 cname:v+XQz6TBI6MEnK7e\r\nm=application 9 UDP/DTLS/SCTP webrtc-datachannel\r\nc=IN IP4 0.0.0.0\r\na=ice-ufrag:tCZF\r\na=ice-pwd:72l2iBynEfefBHSECOvzxWZ0\r\na=fingerprint:sha-256 C2:AA:58:AB:78:8D:2D:D3:FC:0E:06:21:5F:EF:53:22:0E:6A:7C:F2:93:EC:8F:FA:70:10:E5:5E:4E:D1:B0:37\r\na=setup:active\r\na=mid:2\r\na=sctp-port:5000\r\na=max-message-size:262144\r\n",
    });
  };

  const answersignal = () => {
    connectionRef.current.signal({
      type: "offer",
      sdp: "v=0\r\no=- 762773748250282635 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\na=group:BUNDLE 0 1 2\r\na=extmap-allow-mixed\r\na=msid-semantic: WMS evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9\r\nm=audio 10259 UDP/TLS/RTP/SAVPF 111 63 103 104 9 0 8 106 105 13 110 112 113 126\r\nc=IN IP4 150.107.241.94\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 53493 typ host generation 0 network-id 1 network-cost 10\r\na=candidate:4117300730 1 udp 1686052607 150.107.241.94 10259 typ srflx raddr 192.168.31.197 rport 53493 generation 0 network-id 1 network-cost 10\r\na=candidate:2003289753 1 tcp 1518280447 192.168.31.197 9 typ host tcptype active generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:AB7m\r\na=ice-pwd:/nB9dKHRLh+BlXO9F3zn/Syf\r\na=fingerprint:sha-256 E7:D5:2D:62:80:BA:07:5D:E9:D7:22:32:5C:9A:51:A0:D9:27:4C:F4:A0:24:3E:93:A4:A0:6B:CA:2C:E6:11:73\r\na=setup:actpass\r\na=mid:0\r\na=extmap:1 urn:ietf:params:rtp-hdrext:ssrc-audio-level\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=sendrecv\r\na=msid:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9 b6b836f2-f633-46b8-8eb8-080a662045c3\r\na=rtcp-mux\r\na=rtpmap:111 opus/48000/2\r\na=rtcp-fb:111 transport-cc\r\na=fmtp:111 minptime=10;useinbandfec=1\r\na=rtpmap:63 red/48000/2\r\na=fmtp:63 111/111\r\na=rtpmap:103 ISAC/16000\r\na=rtpmap:104 ISAC/32000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:106 CN/32000\r\na=rtpmap:105 CN/16000\r\na=rtpmap:13 CN/8000\r\na=rtpmap:110 telephone-event/48000\r\na=rtpmap:112 telephone-event/32000\r\na=rtpmap:113 telephone-event/16000\r\na=rtpmap:126 telephone-event/8000\r\na=ssrc:3779889204 cname:cD0QGvec5AfQePit\r\na=ssrc:3779889204 msid:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9 b6b836f2-f633-46b8-8eb8-080a662045c3\r\na=ssrc:3779889204 mslabel:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9\r\na=ssrc:3779889204 label:b6b836f2-f633-46b8-8eb8-080a662045c3\r\nm=video 10921 UDP/TLS/RTP/SAVPF 96 97 98 99 100 101 127 121 125 107 108 109 124 120 123 119 35 36 41 42 114 115 116\r\nc=IN IP4 150.107.241.94\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 41949 typ host generation 0 network-id 1 network-cost 10\r\na=candidate:4117300730 1 udp 1686052607 150.107.241.94 10921 typ srflx raddr 192.168.31.197 rport 41949 generation 0 network-id 1 network-cost 10\r\na=candidate:2003289753 1 tcp 1518280447 192.168.31.197 9 typ host tcptype active generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:AB7m\r\na=ice-pwd:/nB9dKHRLh+BlXO9F3zn/Syf\r\na=fingerprint:sha-256 E7:D5:2D:62:80:BA:07:5D:E9:D7:22:32:5C:9A:51:A0:D9:27:4C:F4:A0:24:3E:93:A4:A0:6B:CA:2C:E6:11:73\r\na=setup:actpass\r\na=mid:1\r\na=extmap:14 urn:ietf:params:rtp-hdrext:toffset\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:13 urn:3gpp:video-orientation\r\na=extmap:3 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:5 http://www.webrtc.org/experiments/rtp-hdrext/playout-delay\r\na=extmap:6 http://www.webrtc.org/experiments/rtp-hdrext/video-content-type\r\na=extmap:7 http://www.webrtc.org/experiments/rtp-hdrext/video-timing\r\na=extmap:8 http://www.webrtc.org/experiments/rtp-hdrext/color-space\r\na=extmap:4 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=extmap:10 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id\r\na=extmap:11 urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id\r\na=sendrecv\r\na=msid:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9 6c5ffcfe-7f77-4c93-824f-079cc1031ed5\r\na=rtcp-mux\r\na=rtcp-rsize\r\na=rtpmap:96 VP8/90000\r\na=rtcp-fb:96 goog-remb\r\na=rtcp-fb:96 transport-cc\r\na=rtcp-fb:96 ccm fir\r\na=rtcp-fb:96 nack\r\na=rtcp-fb:96 nack pli\r\na=rtpmap:97 rtx/90000\r\na=fmtp:97 apt=96\r\na=rtpmap:98 VP9/90000\r\na=rtcp-fb:98 goog-remb\r\na=rtcp-fb:98 transport-cc\r\na=rtcp-fb:98 ccm fir\r\na=rtcp-fb:98 nack\r\na=rtcp-fb:98 nack pli\r\na=fmtp:98 profile-id=0\r\na=rtpmap:99 rtx/90000\r\na=fmtp:99 apt=98\r\na=rtpmap:100 VP9/90000\r\na=rtcp-fb:100 goog-remb\r\na=rtcp-fb:100 transport-cc\r\na=rtcp-fb:100 ccm fir\r\na=rtcp-fb:100 nack\r\na=rtcp-fb:100 nack pli\r\na=fmtp:100 profile-id=2\r\na=rtpmap:101 rtx/90000\r\na=fmtp:101 apt=100\r\na=rtpmap:127 H264/90000\r\na=rtcp-fb:127 goog-remb\r\na=rtcp-fb:127 transport-cc\r\na=rtcp-fb:127 ccm fir\r\na=rtcp-fb:127 nack\r\na=rtcp-fb:127 nack pli\r\na=fmtp:127 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f\r\na=rtpmap:121 rtx/90000\r\na=fmtp:121 apt=127\r\na=rtpmap:125 H264/90000\r\na=rtcp-fb:125 goog-remb\r\na=rtcp-fb:125 transport-cc\r\na=rtcp-fb:125 ccm fir\r\na=rtcp-fb:125 nack\r\na=rtcp-fb:125 nack pli\r\na=fmtp:125 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42001f\r\na=rtpmap:107 rtx/90000\r\na=fmtp:107 apt=125\r\na=rtpmap:108 H264/90000\r\na=rtcp-fb:108 goog-remb\r\na=rtcp-fb:108 transport-cc\r\na=rtcp-fb:108 ccm fir\r\na=rtcp-fb:108 nack\r\na=rtcp-fb:108 nack pli\r\na=fmtp:108 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\na=rtpmap:109 rtx/90000\r\na=fmtp:109 apt=108\r\na=rtpmap:124 H264/90000\r\na=rtcp-fb:124 goog-remb\r\na=rtcp-fb:124 transport-cc\r\na=rtcp-fb:124 ccm fir\r\na=rtcp-fb:124 nack\r\na=rtcp-fb:124 nack pli\r\na=fmtp:124 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42e01f\r\na=rtpmap:120 rtx/90000\r\na=fmtp:120 apt=124\r\na=rtpmap:123 H264/90000\r\na=rtcp-fb:123 goog-remb\r\na=rtcp-fb:123 transport-cc\r\na=rtcp-fb:123 ccm fir\r\na=rtcp-fb:123 nack\r\na=rtcp-fb:123 nack pli\r\na=fmtp:123 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f\r\na=rtpmap:119 rtx/90000\r\na=fmtp:119 apt=123\r\na=rtpmap:35 H264/90000\r\na=rtcp-fb:35 goog-remb\r\na=rtcp-fb:35 transport-cc\r\na=rtcp-fb:35 ccm fir\r\na=rtcp-fb:35 nack\r\na=rtcp-fb:35 nack pli\r\na=fmtp:35 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=4d001f\r\na=rtpmap:36 rtx/90000\r\na=fmtp:36 apt=35\r\na=rtpmap:41 AV1/90000\r\na=rtcp-fb:41 goog-remb\r\na=rtcp-fb:41 transport-cc\r\na=rtcp-fb:41 ccm fir\r\na=rtcp-fb:41 nack\r\na=rtcp-fb:41 nack pli\r\na=rtpmap:42 rtx/90000\r\na=fmtp:42 apt=41\r\na=rtpmap:114 red/90000\r\na=rtpmap:115 rtx/90000\r\na=fmtp:115 apt=114\r\na=rtpmap:116 ulpfec/90000\r\na=ssrc-group:FID 2653250432 1744981608\r\na=ssrc:2653250432 cname:cD0QGvec5AfQePit\r\na=ssrc:2653250432 msid:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9 6c5ffcfe-7f77-4c93-824f-079cc1031ed5\r\na=ssrc:2653250432 mslabel:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9\r\na=ssrc:2653250432 label:6c5ffcfe-7f77-4c93-824f-079cc1031ed5\r\na=ssrc:1744981608 cname:cD0QGvec5AfQePit\r\na=ssrc:1744981608 msid:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9 6c5ffcfe-7f77-4c93-824f-079cc1031ed5\r\na=ssrc:1744981608 mslabel:evTcYbKNqpgqL4LGzaOyXGT6YQH0Bxd3qGY9\r\na=ssrc:1744981608 label:6c5ffcfe-7f77-4c93-824f-079cc1031ed5\r\nm=application 9826 UDP/DTLS/SCTP webrtc-datachannel\r\nc=IN IP4 150.107.241.94\r\na=candidate:971258473 1 udp 2122260223 192.168.31.197 59914 typ host generation 0 network-id 1 network-cost 10\r\na=candidate:4117300730 1 udp 1686052607 150.107.241.94 9826 typ srflx raddr 192.168.31.197 rport 59914 generation 0 network-id 1 network-cost 10\r\na=candidate:2003289753 1 tcp 1518280447 192.168.31.197 9 typ host tcptype active generation 0 network-id 1 network-cost 10\r\na=ice-ufrag:AB7m\r\na=ice-pwd:/nB9dKHRLh+BlXO9F3zn/Syf\r\na=fingerprint:sha-256 E7:D5:2D:62:80:BA:07:5D:E9:D7:22:32:5C:9A:51:A0:D9:27:4C:F4:A0:24:3E:93:A4:A0:6B:CA:2C:E6:11:73\r\na=setup:actpass\r\na=mid:2\r\na=sctp-port:5000\r\na=max-message-size:262144\r\n",
    });
  };

  return (
    <Video/>
    // <div className="App">
    //   <button onClick={callUser}>Caller</button>
    //   <button onClick={callsignal}>CallerStr</button>
    //   <button onClick={answerCall}>answerCall</button>
    //   <button onClick={answersignal}>answerCallStr</button>
    //   <div className="videodiv">
    //     <video
    //       playsInline
    //       muted
    //       ref={myVideo}
    //       autoPlay
    //       style={{ width: "300px" }}
    //     />

    //     <video
    //       playsInline
    //       ref={userVideo}
    //       autoPlay
    //       style={{ width: "300px" }}
    //     />
    //   </div>
    // </div>
  );
}

export default App;
